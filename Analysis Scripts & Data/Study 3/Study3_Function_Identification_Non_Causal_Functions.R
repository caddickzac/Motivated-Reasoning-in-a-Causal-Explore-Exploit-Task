#################################################
# Function Identification: Non-Causal Functions #
#################################################

#import libraries
library("tidyverse")
library("lmerTest")

# import data
Study3_Function_Identification_Non_Causal_Functions <- as_tibble(read.csv("Study3_Function_Identification_Non_Causal_Functions.csv"))

# Preview data
head(Study3_Function_Identification_Non_Causal_Functions)

# data dictionary:
## "Participant" = participant number
## "Function_Exposure_Treatment" = denotes whether or not participant received function exposure treatment (see Study 3 method section for details;), 0=no, 1=yes
## "Function" = function number (causal functions only; range 1-4; refer to payoff function figure)
## "Strong_Preference" = denotes if participant had strong preference (yes/no) for a policy
## "Plot_Match_Scored" = did participant correctly identify function->figure matching? (1=correct; 0=incorrect)

# effects coding
Study3_Function_Identification_Non_Causal_Functions$Function_Exposure_Treatment2 <-
  ifelse(Study3_Function_Identification_Non_Causal_Functions$Function_Exposure_Treatment==1,.5,-.5)


m1 <- glmer(Plot_Match_Scored ~ Function_Exposure_Treatment2 + (1|Participant), 
            data=Study3_Function_Identification_Non_Causal_Functions, family='binomial')
summary(m1)

# Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) ['glmerMod']
# Family: binomial  ( logit )
# Formula: Plot_Match_Scored ~ Function_Exposure_Treatment2 + (1 | Participant)
# Data: Study3_Function_Identification_Non_Causal_Functions
# 
# AIC      BIC   logLik deviance df.resid 
# 118.7    127.7    -56.3    112.7      148 
# 
# Scaled residuals: 
#   Min      1Q  Median      3Q     Max 
# -0.5044 -0.2898 -0.2448 -0.2448  2.2784 
# 
# Random effects:
#   Groups      Name        Variance Std.Dev.
# Participant (Intercept) 1.478    1.216   
# Number of obs: 151, groups:  Participant, 77
# 
# Fixed effects:
#   Estimate Std. Error z value Pr(>|z|)    
# (Intercept)                   -2.4477     0.6332  -3.866 0.000111 ***
#   Function_Exposure_Treatment2   0.4001     0.6123   0.653 0.513436    
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
