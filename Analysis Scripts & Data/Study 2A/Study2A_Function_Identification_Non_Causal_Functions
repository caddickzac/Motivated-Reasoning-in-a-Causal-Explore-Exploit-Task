#################################################
# Function Identification: Non-Causal Functions #
#################################################

#import libraries
library("tidyverse")
library("lmerTest")

# import data
Study2A_Function_Identification_Non_Causal_Functions <- as_tibble(read.csv("Study2A_Function_Identification_Non_Causal_Functions.csv"))

# Preview data
head(Study2A_Function_Identification_Non_Causal_Functions)

# data dictionary:
## "Participant" = participant number
## "Function" = function number (causal functions only; range 1-4; refer to payoff function figure)
## "Strong_Preference" = denotes if participant had strong preference (yes/no) for a policy
## "Plot_Match_Scored" = did participant correctly identify function->figure matching? (1=correct; 0=incorrect)

# effects coding
Study2A_Function_Identification_Non_Causal_Functions$Strong_Preference2 <-
  ifelse(Study2A_Function_Identification_Non_Causal_Functions$Strong_Preference=="No",.5,-.5)


m1 <- glmer(Plot_Match_Scored ~ Strong_Preference2 + (1+Strong_Preference2|Participant), 
            data=Study2A_Function_Identification_Non_Causal_Functions, family='binomial',
            control=glmerControl(optimizer="bobyqa"))
summary(m1)

# Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) ['glmerMod']
# Family: binomial  ( logit )
# Formula: Plot_Match_Scored ~ Strong_Preference2 + (1 + Strong_Preference2 |      Participant)
# Data: Study2A_Function_Identification_Non_Causal_Functions
# Control: glmerControl(optimizer = "bobyqa")
# 
# AIC      BIC   logLik deviance df.resid 
# 54.0     69.9    -22.0     44.0      171 
# 
# Scaled residuals: 
#   Min       1Q   Median       3Q      Max 
# -0.98753 -0.00355 -0.00059 -0.00059  1.01263 
# 
# Random effects:
#   Groups      Name               Variance Std.Dev. Corr 
# Participant (Intercept)         814.1   28.53         
# Strong_Preference2 6764.4   82.25    -0.69
# Number of obs: 176, groups:  Participant, 88
# 
# Fixed effects:
#   Estimate Std. Error z value Pr(>|z|)    
# (Intercept)         -13.068      3.392  -3.853 0.000117 ***
#   Strong_Preference2    3.592      6.756   0.532 0.594953    
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# Correlation of Fixed Effects:
#   (Intr)
# Strng_Prfr2 -0.748
