#################################################
# Function Identification: Non-Causal Functions #
#################################################

#import libraries
library("tidyverse")
library("lmerTest")

# import data
Study2B_Function_Identification_Non_Causal_Functions <- as_tibble(read.csv("Study2B_Function_Identification_Non_Causal_Functions.csv"))

# Preview data
head(Study2B_Function_Identification_Non_Causal_Functions)

# data dictionary:
## "Participant" = participant number
## "Function" = function number (causal functions only; range 1-4; refer to payoff function figure)
## "Strong_Preference" = denotes if participant had strong preference (yes/no) for a policy
## "Plot_Match_Scored" = did participant correctly identify function->figure matching? (1=correct; 0=incorrect)

# effects coding
Study2B_Function_Identification_Non_Causal_Functions$Strong_Preference2 <-
  ifelse(Study2B_Function_Identification_Non_Causal_Functions$Strong_Preference=="No",.5,-.5)


m1 <- glmer(Plot_Match_Scored ~ Strong_Preference2 + (1+Strong_Preference2|Participant), 
            data=Study2B_Function_Identification_Non_Causal_Functions, family='binomial',
            control=glmerControl(optimizer="bobyqa"))
summary(m1)
# Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) ['glmerMod']
# Family: binomial  ( logit )
# Formula: Plot_Match_Scored ~ Strong_Preference2 + (1 + Strong_Preference2 |      Participant)
# Data: Study2B_Function_Identification_Non_Causal_Functions
# Control: glmerControl(optimizer = "bobyqa")
# 
# AIC      BIC   logLik deviance df.resid 
# 347.0    368.7   -168.5    337.0      561 
# 
# Scaled residuals: 
#   Min       1Q   Median       3Q      Max 
# -0.97369 -0.46501 -0.00376 -0.00322  2.14372 
# 
# Random effects:
#   Groups      Name               Variance Std.Dev. Corr 
# Participant (Intercept)        105      10.25         
# Strong_Preference2 413      20.32    -1.00
# Number of obs: 566, groups:  Participant, 283
# 
# Fixed effects:
#   Estimate Std. Error z value Pr(>|z|)    
# (Intercept)         -6.3427     0.8362  -7.586 3.31e-14 ***
#   Strong_Preference2   9.6255     1.6660   5.778 7.57e-09 ***
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# Correlation of Fixed Effects:
#   (Intr)
# Strng_Prfr2 -0.982
